{% extends 'base.html.twig' %}

{% block title %}{{ book.title }}{% endblock %}

{% block body %}
    <div class="row">
        <div class="col-md-4 text-center">
            {% if book.imagePath %}
                <img src="{{ asset(book.imagePath) }}" alt="{{ book.title }}" class="img-fluid rounded shadow-sm">
            {% else %}
                <div class="bg-light p-5 rounded">Нет изображения</div>
            {% endif %}
        </div>
        <div class="col-md-8">
            <h1>{{ book.title }}</h1>
            <p><strong>Авторы:</strong> {{ book.authors|join(', ') }}</p>
            {% if book.isbn %}<p><strong>ISBN (артикул):</strong> {{ book.isbn }}</p>{% endif %}
            {% if book.pageCount %}<p><strong>Количество страниц:</strong> {{ book.pageCount }}</p>{% endif %}
            {% if book.publishedDate %}<p><strong>Дата публикации:</strong> {{ book.publishedDate|date('d.m.Y') }}</p>{% endif %}
            <p><strong>Статус:</strong> <span class="badge bg-info">{{ book.status }}</span></p>

            {% if book.categories|length > 0 %}
                <p><strong>Категории:</strong>
                    {% for category in book.categories %}
                        <a href="{{ path('category_show', {id: category.id}) }}" class="badge bg-secondary text-decoration-none me-1">
                            {{ category.name }}
                        </a>
                    {% endfor %}
                </p>
            {% endif %}
        </div>
    </div>

    {# TODO
    Добавить табы: "Описание", "Авторы", "Отзывы"
    Сделать карточки книг кликабельными
    Добавить закладки
    Показывать рейтинг (если будет система отзывов)
    Добавить хлебные крошки: Главная / Категория / Книга
    #}

    {% if relatedBooks|length > 0 %}
        <div class="mt-5">
            <h4>Похожие книги</h4>
            <div class="row">
                {% for b in relatedBooks %}
                    <div class="col-md-3">
                        <div class="card">
                            {% if b.imagePath %}
                                <img src="{{ asset(b.imagePath) }}" alt="{{ b.title }}" class="card-img-top" style="height: 120px; object-fit: cover;">
                            {% endif %}
                            <div class="card-body p-2">
                                <a href="{{ path('book_show', {id: b.id}) }}" class="text-decoration-none">{{ b.title|u.truncate(30) }}</a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endif %}

    <div class="mt-4">
        <a href="{{ path('category_index') }}" class="btn btn-secondary btn-sm">&larr; Все категории</a>
    </div>
{% endblock %}